
  subroutine imex_schemes

    use scalar
    use parameters

    implicit none

  !     ------------
  !     IMEX SSP-schemes
  !     ------------

    if (order == 1) then

      wb(1:1)     = (/ 1.d0 /)
      wbt(1:1)    = (/ 0.d0 /)
      
      Ab (1, 1:1) = (/ 1.d0 /)

      Abt(1,1:1)  =  (/ 0.d0  /)

   else if (order == 2) then

      if (MIRK ==2) then


      !     MIRK

      wb(1:2) =(/ 0.5d0,0.5d0 /)
      wbt(1:2)=(/ 0.0d0,0.0d0 /)
      
      Ab(1, 1:2) = (/ 0.d0,0.d0 /)
      Ab(2, 1:2) = (/ 1.d0,0.d0 /)

      Abt(1,1:2) = (/ 0.d0,0.d0 /)
      Abt(2,1:2) = (/ 0.d0,0.d0 /)

      else if (MIRK == 0) then

      !     IMEX SSP2(2,2,2)  OK  

      wb(1:2) =(/ 0.5d0,0.5d0 /)
      wbt(1:2)=(/ 0.5d0,0.5d0 /)
      
      Ab(1, 1:2) = (/ 0.d0,0.d0 /)
      Ab(2, 1:2) = (/ 1.d0,0.d0 /)

      Abt(1,1:2) = (/ const          , 0.d0  /)
      Abt(2,1:2) = (/ 1.d0-2.d0*const, const /)

      else 

         write(*,*) "this combination of parameters order and MIRK is not correctly)"

      stop

      end if

   else if (order == 3) then

      !     IMEX SSP2(3,3,2)-LU  OK

!!$      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0 ,0.d0 ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0,0.d0 ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.5d0,0.5d0,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 0.25d0   ,0.d0     ,0.d0     /)
!!$      Abt(2,1:3) = (/ 0.d0     ,0.25d0   ,0.d0     /)
!!$      Abt(3,1:3) = (/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0/)

      !     IMEX SSP2H(3,3,2)   SIAM J. Numer. Anal., 44 (2006), Inmaculada OK SSP2(332)-LUM


      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)

      Ab(1, 1:3) = (/ 0.d0 ,0.d0 ,0.d0 /)
      Ab(2, 1:3) = (/ 0.5d0,0.d0 ,0.d0 /)
      Ab(3, 1:3) = (/ 0.5d0,0.5d0,0.d0 /)
    
      Abt(1,1:3) = (/ 1.d0/5.d0  ,0.d0      ,0.d0     /)
      Abt(2,1:3) = (/ 1.d0/10.d0 ,1.d0/5.d0 ,0.d0     /)
      Abt(3,1:3) = (/ 1.d0/3.d0  ,1.d0/3.d0 ,1.d0/3.d0/)


       !This methods will be denoted by IMEX-RK23S_E . Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 12)

     
!!$      wb(1:3) =(/ 0.480520005477614d0,0.396275778012860d0,0.123204216509527d0 /)
!!$      wbt(1:3)=(/ 0.480520005477614d0,0.396275778012860d0,0.123204216509527d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0 ,0.d0 ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 1.001189204627373d0,0.d0 ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.253545544784129d0,0.584518053390108d0,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 0.743134194610956d0  ,0.d0      ,0.d0     /)
!!$      Abt(2,1:3) = (/ -1.641178073188283d0 ,0.743134194610956d0 ,0.d0     /)
!!$      Abt(3,1:3) = (/  1.132080119545815d0 ,2.173203861281970d0 ,0.743134194610956d0/)



      !This methods will be denoted by IMEX-RK23S_π/2 . Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 13)


!!$      wb(1:3) =(/ 0.396284461794023d0,0.281418137752127d0,0.322297400453850d0 /)
!!$      wbt(1:3)=(/ 0.396284461794023d0,0.281418137752127d0,0.322297400453850d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0 ,0.d0 ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.577185900656255d0,0.d0 ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.659759720087210d0,0.387625143163863d0,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 0.331054829332169d0 ,0.d0      ,0.d0     /)
!!$      Abt(2,1:3) = (/ 0.710590273435981d0 ,0.331054829332169d0 ,0.d0     /)
!!$      Abt(3,1:3) = (/-0.126881367560843d0 ,0.030610591738250d0 ,0.331054829332169d0/)
      


      !This methods will be denoted by IMEX-RK23SSP.  . Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 14)


!!$      wb (1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0 ,0.d0 ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0,0.d0 ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.5d0,0.5d0,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 0.204976822001215d0 ,0.d0      ,0.d0     /)
!!$      Abt(2,1:3) = (/ 0.481938954920455d0 ,0.204976822001215d0 ,0.d0     /)
!!$      Abt(3,1:3) = (/ 0.250998127128454d0 ,0.152132451947445d0 ,0.204976822001215d0/)

      !This method will be denoted by IMEX-RK33λ. Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 16)


!!$      wb (1:3)=(/ 0.d0,3.d0/4.d0,1.d0/4.d0 /)
!!$      wbt(1:3)=(/ 0.d0,3.d0/4.d0,1.d0/4.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0     ,0.d0 ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 1.d0/3.d0,0.d0 ,0.d0 /)
!!$      Ab(3, 1:3) = (/-1.d0     ,2.d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ (3.d0 + sqrt(3.d0))/6.d0 ,0.d0                     ,0.d0 /)
!!$      Abt(2,1:3) = (/-(1.d0 + sqrt(3.d0))/6.d0 ,(3.d0 + sqrt(3.d0))/6.d0 ,0.d0 /)
!!$      Abt(3,1:3) = (/ (1.d0 + sqrt(3.d0))/2.d0 ,(1.d0 - sqrt(3.d0))/2.d0 ,0.d0 /)

      

      !     IMEX SSP3(3,3,2)   NO

!!$      wb(1:3) =(/ 1.d0/6.d0,1.d0/6.d0,2.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/6.d0,1.d0/6.d0,2.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0   ,0.d0   ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 1.d0   ,0.d0   ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.25d0 ,0.25d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ const           ,0.d0 ,0.d0 /)
!!$      Abt(2,1:3) = (/ 1.0d0-2.d0*const,const,0.d0 /)
!!$      Abt(3,1:3) = (/ 0.5d0-const     ,0.d0 ,const /)


      !     IMEX DP-ARS(1,2,1)   OK

!!$      wb(1:3) =(/ 1.d0,0.d0,0.d0 /)
!!$      wbt(1:3)=(/ 0.d0,1.d0-const,const /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0   ,0.d0   ,0.d0 /)
!!$      Ab(2, 1:3) = (/ delta  ,0.d0   ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 1.d0   ,0.d0    ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 0.d0 ,0.d0       ,0.d0 /)
!!$      Abt(2,1:3) = (/ 0.d0 ,const      ,0.d0 /)
!!$      Abt(3,1:3) = (/ 0.d0 ,1.d0-const ,const /)



      !     IMEX order 3-stage SSP Inmaculada 2012  ecu(3.30) SSP2(332)-LSPUM SSP2H_LSPUM(332)

!!$      wb(1:3) =(/ 24.d0/55.d0,1.d0/5.d0,4.d0/11.d0 /)
!!$      wbt(1:3)=(/ 24.d0/55.d0,1.d0/5.d0,4.d0/11.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0        ,0.d0        ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 5.d0/6.d0   ,0.d0        ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 11.d0/24.d0 ,11.d0/24.d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 2.d0/11.d0       ,0.d0        ,0.d0       /)
!!$      Abt(2,1:3) = (/ 205.d0/462.d0   ,2.d0/11.d0   ,0.d0       /)
!!$      Abt(3,1:3) = (/ 2033.d0/4620.d0 ,21.d0/110.d0 ,2.d0/11.d0 /)


      !     IMEX order 3-stage SSP Optimus Inmaculada 2012  NO

!!$      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0  ,0.d0  ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0 ,0.d0  ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.5d0 ,0.5d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 2.d0/11.d0    ,0.d0         ,0.d0       /)
!!$      Abt(2,1:3) = (/ 41.d0/154.d0  ,2.d0/11.d0   ,0.d0       /)
!!$      Abt(3,1:3) = (/ 289.d0/847.d0 ,42.d0/121.d0 ,2.d0/11.d0 /)

      !     IMEX order 3-stage SSP Large radius of absolute monotonicity Inmaculada 2012  NO

!!$      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0  ,0.d0  ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0 ,0.d0  ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.5d0 ,0.5d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 2.d0/11.d0          ,0.d0       ,0.d0       /)
!!$      Abt(2,1:3) = (/ 2829.d0/9317.d0     ,2.d0/11.d0 ,0.d0       /)
!!$      Abt(3,1:3) = (/ 148529.d0/428582.d0 ,7.d0/23.d0 ,2.d0/11.d0 /)

      !     IMEX order 3-stage SSP Large radius of absolute monotonicity Inmaculada 2012  NO

!!$      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0  ,0.d0  ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0 ,0.d0  ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.5d0 ,0.5d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 2.d0/11.d0         ,0.d0        ,0.d0       /)
!!$      Abt(2,1:3) = (/ 2583.d0/13310.d0   ,2.d0/11.d0  ,0.d0       /)
!!$      Abt(3,1:3) = (/ 39731.d0/139755.d0 ,10.d0/21.d0 ,2.d0/11.d0 /)

      !     IMEX order 3-stage with optimal SSP DIRK Inmaculada 2012 (A)   NO

!!$      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0  ,0.d0  ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0 ,0.d0  ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 0.5d0 ,0.5d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 1.d0/6.d0 ,0.d0      ,0.d0       /)
!!$      Abt(2,1:3) = (/ 1.d0/3.d0 ,1.d0/6.d0 ,0.d0       /)
!!$      Abt(3,1:3) = (/ 1.d0/3.d0 ,1.d0/3.d0 ,1.d0/6.d0 /)

      !     IMEX order 3-stage with optimal SSP DIRK Inmaculada 2012 (B)  NO

!!$      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0      ,0.d0      ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0     ,0.d0      ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 1.d0/6.d0 ,5.d0/6.d0 ,0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 1.d0/6.d0 ,0.d0      ,0.d0       /)
!!$      Abt(2,1:3) = (/ 1.d0/3.d0 ,1.d0/6.d0 ,0.d0       /)
!!$      Abt(3,1:3) = (/ 1.d0/3.d0 ,1.d0/3.d0 ,1.d0/6.d0 /)

      !     IMEX order 3-stage with optimal SSP DIRK Inmaculada 2012 (C)   NO

!!$      wb(1:3) =(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$      wbt(1:3)=(/ 1.d0/3.d0,1.d0/3.d0,1.d0/3.d0 /)
!!$
!!$      Ab(1, 1:3) = (/ 0.d0                      ,0.d0                 ,0.d0 /)
!!$      Ab(2, 1:3) = (/ 0.5d0*sqrt(5.d0/3.d0)     ,0.d0                 ,0.d0 /)
!!$      Ab(3, 1:3) = (/ 3.d0/2.d0-sqrt(5.d0/3.d0) ,0.5d0*sqrt(5.d0/3.d0),0.d0 /)
!!$    
!!$      Abt(1,1:3) = (/ 1.d0/6.d0 ,0.d0      ,0.d0       /)
!!$      Abt(2,1:3) = (/ 1.d0/3.d0 ,1.d0/6.d0 ,0.d0       /)
!!$      Abt(3,1:3) = (/ 1.d0/3.d0 ,1.d0/3.d0 ,1.d0/6.d0 /)




   else if (order == 4) then


      !     IMEX SSP3(4,3,3)  NO

      wb(1:4) =(/ 0.d0,1.d0/6.d0,1.d0/6.d0,2.d0/3.d0 /)
      wbt(1:4)=(/ 0.d0,1.d0/6.d0,1.d0/6.d0,2.d0/3.d0 /)

      Ab(1, 1:4) = (/ 0.d0 ,0.d0   ,0.d0   ,0.d0 /)
      Ab(2, 1:4) = (/ 0.d0 ,0.d0   ,0.d0   ,0.d0 /)
      Ab(3, 1:4) = (/ 0.d0 ,1.d0   ,0.d0   ,0.d0 /)
      Ab(4, 1:4) = (/ 0.d0 ,0.25d0 ,0.25d0 ,0.d0 /)
    
      Abt(1,1:4) = (/ alpha1       ,0.d0       ,0.d0                     ,0.d0   /)
      Abt(2,1:4) = (/ -1.d0*alpha1 ,alpha1     ,0.d0                     ,0.d0   /)
      Abt(3,1:4) = (/ 0.d0         ,1.d0-alpha1,alpha1                   ,0.d0   /)
      Abt(4,1:4) = (/ beta1        ,etha1      ,0.5d0-beta1-etha1-alpha1 ,alpha1 /)
   
      !     IMEX DP2-A(2,4,2)  OK CFL = 0.3 0. const = 1.3 - 1/sqrt(2) !!!!!

!!$      wb(1:4) =(/ 0.d0, 0.5d0, 0.5d0, 0.d0 /)
!!$      wbt(1:4)=(/ 0.d0, 0.5d0, 0.5d0-const,const /)
!!$
!!$      Ab(1, 1:4) = (/ 0.d0 ,0.d0   ,0.d0   ,0.d0 /)
!!$      Ab(2, 1:4) = (/ 0.d0 ,0.d0   ,0.d0   ,0.d0 /)
!!$      Ab(3, 1:4) = (/ 0.d0 ,1.d0   ,0.d0   ,0.d0 /)
!!$      Ab(4, 1:4) = (/ 0.d0 ,0.5d0  ,0.5d0  ,0.d0 /)
!!$    
!!$      Abt(1,1:4) = (/ const        ,0.d0       ,0.d0                     ,0.d0   /)
!!$      Abt(2,1:4) = (/ -const       ,const      ,0.d0                     ,0.d0   /)
!!$      Abt(3,1:4) = (/ 0.d0         ,1.d0-const ,const                    ,0.d0   /)
!!$      Abt(4,1:4) = (/ 0.d0         ,0.5d0      ,0.5d0-const              ,const /)

      !     IMEX DP1-A(2,4,2)  NO

!!$      wb(1:4) =(/ 0.5d0, 0.d0, 0.5d0, 0.d0 /)
!!$      wbt(1:4)=(/ 1.5d0, -1.5d0, 0.5d0,0.5d0 /)
!!$
!!$      Ab(1, 1:4) = (/ 0.d0      ,0.d0   ,0.d0   ,0.d0 /)
!!$      Ab(2, 1:4) = (/ THIRD ,0.d0   ,0.d0   ,0.d0 /)
!!$      Ab(3, 1:4) = (/ 1.d0      ,0.d0   ,0.d0   ,0.d0 /)
!!$      Ab(4, 1:4) = (/ 0.5d0     ,0.d0  ,0.5d0  ,0.d0 /)
!!$    
!!$      Abt(1,1:4) = (/ 0.5d0      ,0.d0       ,0.d0   ,0.d0   /)
!!$      Abt(2,1:4) = (/ 1.d0/6.d0  ,0.5d0      ,0.d0   ,0.d0   /)
!!$      Abt(3,1:4) = (/ -0.5d0     ,0.5d0      ,0.5d0  ,0.d0   /)
!!$      Abt(4,1:4) = (/ 1.5d0  ,-1.5d0 ,0.5d0  ,0.5d0 /)
   
   else if (order == 5) then


      !     IMEX ARS(4,4,3)  S. BOSCARINO, L. PARESCHI , AND G.RUSSO 2012  NO

      wb (1:5)=(/ 1.d0/4.d0,7.d0/4.d0,3.d0/4.d0 ,-7.d0/4.d0,0.d0 /)
      wbt(1:5)=(/ 0.d0     ,3.d0/2.d0,-3.d0/2.d0, 0.5d0    ,0.5d0 /)

      Ab(1, 1:5) = (/ 0.d0        ,0.d0       , 0.d0     ,0.d0       , 0.d0 /)
      Ab(2, 1:5) = (/ 0.5d0       ,0.d0       , 0.d0      ,0.d0      , 0.d0 /)
      Ab(3, 1:5) = (/ 11.d0/18.d0 ,1.d0/18.d0 , 0.d0      ,0.d0      , 0.d0 /)
      Ab(4, 1:5) = (/ 5.d0/6.d0   ,-5.d0/6.d0 , 0.5d0     ,0.d0      , 0.d0 /)
      Ab(5, 1:5) = (/ 1.d0/4.d0   ,7.d0/4.d0  , 3.d0/4.d0 ,-7.d0/4.d0, 0.d0 /)
    
      Abt(1,1:5) = (/ 0.d0 , 0.d0      ,0.d0       ,0.d0            ,0.d0   /)
      Abt(2,1:5) = (/ 0.d0 , 0.5d0     ,0.d0       ,0.d0            ,0.d0   /)
      Abt(3,1:5) = (/ 0.d0 ,1.d0/6.d0  ,0.5d0      ,0.d0            ,0.d0   /)
      Abt(4,1:5) = (/ 0.d0 ,-0.5d0     ,0.5d0      ,0.5d0           ,0.d0   /)
      Abt(5,1:5) = (/ 0.d0 , 3.d0/2.d0 ,- 3.d0/2.d0,0.5d0           ,0.5d0  /)

      !     IMEX BPR(3,5,3)  S. BOSCARINO, L. PARESCHI , AND G.RUSSO 2012  NO


!!$      wb (1:5)=(/ 1.d0/4.d0,0.d0,3.d0/4.d0, 0.d0 ,0.d0 /)
!!$      wbt(1:5)=(/ 1.d0/4.d0,0.d0,3.d0/4.d0,-0.5d0,0.5d0 /)
!!$
!!$      Ab(1, 1:5) = (/ 0.d0      ,0.d0      ,0.d0      ,0.d0      , 0.d0 /)
!!$      Ab(2, 1:5) = (/ 1.d0      ,0.d0      ,0.d0      ,0.d0      , 0.d0 /)
!!$      Ab(3, 1:5) = (/ 4.d0/9.d0 ,2.d0/9.d0 ,0.d0      ,0.d0      , 0.d0 /)
!!$      Ab(4, 1:5) = (/ 1.d0/4.d0 ,0.d0      ,3.d0/4.d0 ,0.d0      , 0.d0 /)
!!$      Ab(5, 1:5) = (/ 1.d0/4.d0 ,0.d0      ,3.d0/4.d0 ,0.d0      , 0.d0 /)
!!$    
!!$      Abt(1,1:5) = (/ 0.d0       , 0.d0      ,0.d0      , 0.d0    ,0.d0  /)
!!$      Abt(2,1:5) = (/ 0.5d0      , 0.5d0     ,0.d0      , 0.d0    ,0.d0  /)
!!$      Abt(3,1:5) = (/ 5.d0/18.d0 ,-1.d0/9.d0 ,0.5d0     , 0.d0    ,0.d0  /)
!!$      Abt(4,1:5) = (/ 0.5d0      , 0.d0      ,0.d0      , 0.5d0   ,0.d0  /)
!!$      Abt(5,1:5) = (/ 1.d0/4.d0  , 0.d0      ,3.d0/4.d0 ,-0.5d0   ,0.5d0 /)

   else if (order == 6) then


      !     This method will be denoted by IMEX-RK36S_E . Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 17)

      wb (1:6)=(/-0.035877095577305d0,0.673080876788404d0,0.149064711243777d0,&
                 0.137173305022086d0,0.150219587614740d0,-0.073661385091702d0 /)
      wbt(1:6)=(/-0.035877095577305d0,0.673080876788404d0,0.149064711243777d0,&
                 0.137173305022086d0,0.150219587614740d0,-0.073661385091702d0 /)

      Ab(1, 1:6) = (/ 0.d0                ,0.d0               , 0.d0               ,&
                      0.d0                , 0.d0              , 0.d0  /)
      Ab(2, 1:6) = (/ 0.342975342284516d0 ,0.d0               , 0.d0               ,&
                      0.d0                , 0.d0              , 0.d0  /)
      Ab(3, 1:6) = (/ 0.016193013787920d0 ,0.309787886268879d0, 0.d0               ,&
                      0.d0                , 0.d0              , 0.d0  /)
      Ab(4, 1:6) = (/-0.135950059698287d0 ,0.640189764616023d0, 0.342154021907072d0,&
                      0.d0                , 0.d0              , 0.d0  /)
      Ab(5, 1:6) = (/-0.042056958294301d0 ,0.660781723165128d0,-0.381308869908091d0,&
                      1.001236515566727d0 , 0.d0              , 0.d0  /)
      Ab(6, 1:6) = (/ 0.099109299514465d0 ,-0.466919631638661d0,1.030492210860962d0,&
                      0.564549736036252d0 ,-0.119257987827582d0, 0.d0  /)
    
      Abt(1,1:6) = (/ 0.449855695709406d0 , 0.d0               ,0.d0                ,&
                      0.d0                ,0.d0                , 0.d0   /)
      Abt(2,1:6) = (/-0.295189486209790d0 ,0.449855695709406d0 ,0.d0                ,&
                      0.d0                ,0.d0                ,0.d0   /)
      Abt(3,1:6) = (/ 0.879036496969614d0 ,-0.042071370873823d0,0.449855695709406d0 ,&
                      0.d0                ,0.d0                , 0.d0   /)
      Abt(4,1:6) = (/ 0.751731896214317d0 ,-0.222508174774298d0,0.220689305480633d0 ,&
                      0.449855695709406d0 ,0.d0                , 0.d0   /)
      Abt(5,1:6) = (/-0.039570781554756d0 ,0.788509712948086d0 ,0.685131268735182d0 ,&
                     -0.144071924307435d0 ,0.449855695709406d0 , 0.d0  /)
      Abt(6,1:6) = (/ 0.382760589609172d0 ,-0.196622622060158d0,0.904049611197476d0 ,&
                      0.680864149962184d0 ,0.571862669923976d0 ,0.449855695709406d0 /)



            !     This method will be denoted by IMEX-RK36S π/2 . Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 18)

!!$      wb (1:6)=(/ 134.d0/143.d0,-413.d0/3097.d0,830.d0/1311.d0 ,-430.d0/847.d0,-427.d0/9602.d0,85.d0/737.d0 /)
!!$      wbt(1:6)=(/ 134.d0/143.d0,-413.d0/3097.d0,830.d0/1311.d0 ,-430.d0/847.d0,-427.d0/9602.d0,85.d0/737.d0 /)
!!$
!!$      Ab(1, 1:6) = (/ 0.d0           ,0.d0            , 0.d0          ,0.d0            , 0.d0           , 0.d0  /)
!!$      Ab(2, 1:6) = (/ 243.d0/1945.d0 ,0.d0            , 0.d0          ,0.d0            , 0.d0           , 0.d0  /)
!!$      Ab(3, 1:6) = (/-2988.d0/3461.d0,422.d0/275.d0   , 0.d0          ,0.d0            , 0.d0           , 0.d0  /)
!!$      Ab(4, 1:6) = (/ 1434.d0/2177.d0,-1522.d0/2231.d0,-71.d0/4019.d0 ,0.d0            , 0.d0           , 0.d0  /)
!!$      Ab(5, 1:6) = (/-817.d0/10401.d0,-768.d0/1843.d0 , 631.d0/680.d0 ,2113.d0/1492.d0 , 0.d0           , 0.d0  /)
!!$      Ab(6, 1:6) = (/ 540.d0/2599.d0 , 859.d0/915.d0  ,1235.d0/1813.d0,-1912.d0/7025.d0,-1762.d0/7705.d0, 0.d0  /)
!!$    
!!$      Abt(1,1:6) = (/ 395.d0/949.d0   , 0.d0          ,0.d0           ,0.d0          ,0.d0           , 0.d0   /)
!!$      Abt(2,1:6) = (/ 1527.d0/32900.d0,395.d0/949.d0  ,0.d0           ,0.d0          ,0.d0           , 0.d0   /)
!!$      Abt(3,1:6) = (/ 210.d0/5191.d0  ,165.d0/2384.d0 ,395.d0/949.d0  ,0.d0          ,0.d0           , 0.d0   /)
!!$      Abt(4,1:6) = (/-499.d0/1637.d0  ,1817.d0/5159.d0,433.d0/2921.d0 ,395.d0/949.d0 ,0.d0           , 0.d0   /)
!!$      Abt(5,1:6) = (/ 2015.d0/1298.d0 ,1015.d0/1192.d0,1791.d0/1630.d0,251.d0/2423.d0,395.d0/949.d0  , 0.d0   /)
!!$      Abt(6,1:6) = (/ 636.d0/575.d0   ,139.d0/141.d0  ,2331.d0/2332.d0,-103.d0/199.d0,-283.d0/1961.d0,395.d0/949.d0 /)



         else if (order == 8) then


      !     This method will be denoted by IMEX-RK36S_E . Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 21)

!!$            wb (1:8)=(/43.d0/142610.d0,485.d0/3662.d0,849.d0/1915.d0,502.d0/1401.d0&
!!$                     ,-73.d0/2952.d0,318.d0/3289.d0,-339.d0/41053.d0,47.d0/24734.d0/)
!!$            wbt(1:8)=(/43.d0/142610.d0,485.d0/3662.d0,849.d0/1915.d0,502.d0/1401.d0&
!!$                     ,-73.d0/2952.d0,318.d0/3289.d0,-339.d0/41053.d0,47.d0/24734.d0/)
!!$
!!$            Ab(1, 1:8) = (/ 0.d0            ,0.d0            , 0.d0           ,0.d0          &
!!$                           , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
!!$            Ab(2, 1:8) = (/ 326.d0/1379.d0  ,0.d0            , 0.d0           ,0.d0          &
!!$                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
!!$            Ab(3, 1:8) = (/-1450.d0/19477.d0,1031.d0/3191.d0 , 0.d0           ,0.d0          &
!!$                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
!!$            Ab(4, 1:8) = (/ 128.d0/15375.d0 ,-69.d0/1555.d0  ,873.d0/1000.d0  ,0.d0          &
!!$                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
!!$            Ab(5, 1:8) = (/ 377.d0/7459.d0  ,959.d0/1044.d0  ,-119.d0/10006.d0,943.d0/2194.d0&
!!$                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
!!$            Ab(6, 1:8) = (/ 39.d0/10744.d0  ,181.d0/216294.d0,254.d0/1269.d0  ,573.d0/832.d0 &
!!$                 ,179.d0/1766.d0 , 0.d0         , 0.d0          , 0.d0 /)
!!$            Ab(7, 1:8) = (/ 113.d0/5084.d0  ,902.d0/2137.d0  ,127.d0/6960.d0  ,57.d0/7948.d0 &
!!$                 ,713.d0/10786.d0,492.d0/2585.d0, 0.d0          , 0.d0 /)
!!$            Ab(8, 1:8) = (/-372.d0/3299.d0  ,195.d0/8234.d0  ,581.d0/1495.d0  ,569.d0/622.d0 &
!!$                 ,207.d0/2612.d0 ,169.d0/2983.d0, 255.d0/4057.d0, 0.d0 /)
!!$      
!!$    
!!$            Abt(1,1:8) = (/ 1905.d0/3943.d0 , 0.d0           ,0.d0           ,0.d0            &
!!$                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
!!$            Abt(2,1:8) = (/-1159.d0/27874.d0,1095.d0/3943.d0 ,0.d0           ,0.d0            &
!!$                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
!!$            Abt(3,1:8) = (/ 91.d0/1265.d0   ,-116.d0/1149.d0 ,1095.d0/3943.d0,0.d0            &
!!$                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
!!$            Abt(4,1:8) = (/-2538.d0/5135.d0 ,-283.d0/674.d0  ,1897.d0/1287.d0,1095.d0/3943.d0 &
!!$                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
!!$            Abt(5,1:8) = (/ 3545.d0/2933.d0 ,1243.d0/331.d0  ,-859.d0/554.d0 ,-196.d0/85.d0   &
!!$                 ,1095.d0/3943.d0, 0.d0,  0.d0                   , 0.d0 /)
!!$            Abt(6,1:8) = (/ 2729.d0/1518.d0 ,1471.d0/425.d0  ,-1100.d0/317.d0,-3138.d0/2975.d0&
!!$                 ,-77.d0/6619.d0 ,1095.d0/3943.d0,  0.d0         , 0.d0 /)
!!$            Abt(7,1:8) = (/ 125.d0/3524.d0  ,-1151.d0/4318.d0,238.d0/369.d0  ,-637.d0/792.d0  &
!!$                 ,-971.d0/680.d0 ,1341.d0/572.d0 ,1095.d0/3943.d0, 0.d0 /)
!!$            Abt(8,1:8) = (/ 681.d0/191.d0   ,2337.d0/281.d0  ,-3396.d0/409.d0,-1122.d0/523.d0 &
!!$                 ,2521.d0/872.d0 ,-4265.d0/788.d0,4247.d0/2011.d0,1095.d0/3943.d0 /)


            
                  !     This method will be denoted by IMEX-RK48SSP . Giuseppe Izzo, Zdzislaw Jackiewicz 2016 (pag 24)

            wb (1:8)=(/0.d0,277.d0/1720.d0,385.d0/1314.d0,587.d0/1885.d0&
                     , 31.d0/18247.d0,665.d0/2906.d0,0.d0,23.d0/5731.d0/)
            wbt(1:8)=(/0.d0,277.d0/1720.d0,385.d0/1314.d0,587.d0/1885.d0&
                     , 31.d0/18247.d0,665.d0/2906.d0,0.d0,23.d0/5731.d0/)

            Ab(1, 1:8) = (/ 0.d0            ,0.d0            , 0.d0           ,0.d0           & 
                           , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
            Ab(2, 1:8) = (/ 0.d0  ,0.d0            , 0.d0           ,0.d0                     &
                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
            Ab(3, 1:8) = (/ 0.d0,966.d0/2039.d0 , 0.d0           ,0.d0                        &
                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
            Ab(4, 1:8) = (/ 0.d0 ,199.d0/5291.d0  ,735.d0/1709.d0  ,0.d0                      &
                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
            Ab(5, 1:8) = (/ 0.d0  ,306.d0/4373.d0  ,533.d0/1060.d0,773.d0/628.d0              &
                 , 0.d0          , 0.d0         , 0.d0          , 0.d0 /)
            Ab(6, 1:8) = (/ 0.d0, 61.d0/10399.d0,552.d0/8267.d0 , 881.d0/1054.d0              &
                 ,52.d0/9395.d0 , 0.d0         , 0.d0          , 0.d0 /)
            Ab(7, 1:8) = (/ 184.d0/2869.d0  ,141.d0/3059.d0  ,826.d0/1929.d0  ,1567.d0/757.d0 &
                 ,1754.d0/977.d0,161.d0/599.d0, 0.d0          , 0.d0 /)
            Ab(8, 1:8) = (/ 0.d0 ,27.d0/359.d0  ,227.d0/2338.d0  ,53.d0/557.d0                &
                 ,569.d0/4644.d0 ,859.d0/1966.d0, 0.d0, 0.d0 /)
      
    
            Abt(1,1:8) = (/ 1026.d0/3919.d0 , 0.d0           ,0.d0           ,0.d0              &
                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
            Abt(2,1:8) = (/-1148.d0/4385.d0,1026.d0/3919.d0 ,0.d0           ,0.d0               &
                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
            Abt(3,1:8) = (/-1165.d0/2683.d0   ,904.d0/1399.d0 ,1026.d0/3919.d0,0.d0             &
                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
            Abt(4,1:8) = (/ 1480.d0/2439.d0 ,-1469.d0/4070.d0  ,-121.d0/3026.d0,1026.d0/3919.d0 &
                 ,0.d0           , 0.d0,  0.d0                   , 0.d0 /)
            Abt(5,1:8) = (/-2788.d0/397.d0 ,2069.d0/294.d0  ,722.d0/339.d0 ,-411.d0/682.d0      &
                 ,1026.d0/3919.d0, 0.d0,  0.d0                   , 0.d0 /)
            Abt(6,1:8) = (/-165.d0/12667.d0 ,105.d0/671.d0  ,133.d0/500.d0,1307.d0/5430.d0      &
                 ,55.d0/26474.d0 ,1026.d0/3919.d0,  0.d0         , 0.d0 /)
            Abt(7,1:8) = (/ 837.d0/1003.d0  ,629.d0/1976.d0,1195.d0/149.d0  ,-5209.d0/618.d0    &
                 ,1045.d0/1459.d0 ,2767.d0/911.d0 ,1026.d0/3919.d0, 0.d0 /)
            Abt(8,1:8) = (/-752.d0/647.d0   ,-771.d0/2338.d0  ,3197.d0/469.d0,2313.d0/586.d0    &
                 ,-2267.d0/2341.d0 ,-2128.d0/275.d0,0.d0,1026.d0/3919.d0 /)
      
   else  

      stop "this scheme is not implemented yet"

   end if

   return

 end subroutine imex_schemes

